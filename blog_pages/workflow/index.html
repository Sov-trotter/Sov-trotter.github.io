<!doctype html> <!-- Minimal Mistakes Jekyll Theme 4.16.4 by Michael Rose Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes Free for personal and commercial use under the MIT license https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE --> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/libs/highlight/github.min.css"> <link rel=stylesheet  href="/css/franklin.css"> <link rel=stylesheet  href="/css/minimal-mistakes.css"> <link rel=stylesheet  href="/css/adjust.css"> <!--[if IE ]> <style> /* old IE unsupported flexbox fixes */ .greedy-nav .site-title { padding-right: 3em; } .greedy-nav button { position: absolute; top: 0; right: 0; height: 100%; } </style> <![endif]--> <title>Workflow</title> <body class=layout--single > <div class=masthead > <div class=masthead__inner-wrap > <div class=masthead__menu > <nav id=site-nav  class=greedy-nav > <a class=site-title  href="/">Arsh Sharma</a> <div class=nav-social-icons > <a href="https://x.com/Sov_trotter" target=_blank  class=nav-social-icon  title="X (formerly Twitter)"> <svg width=18  height=18  viewBox="0 0 24 24" fill=currentColor > <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/> </svg> </a> <a href="https://linkedin.com/in/Sov-trotter" target=_blank  class=nav-social-icon  title=LinkedIn > <svg width=18  height=18  viewBox="0 0 24 24" fill=currentColor > <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/> </svg> </a> <a href="https://github.com/Sov-trotter" target=_blank  class=nav-social-icon  title=GitHub > <svg width=18  height=18  viewBox="0 0 24 24" fill=currentColor > <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/> </svg> </a> <a href="mailto:sharmarsh15@gmail.com" class=nav-social-icon  title=Email > <svg width=18  height=18  viewBox="0 0 24 24" fill=currentColor > <path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/> </svg> </a> </div> <ul class=visible-links > <li class=masthead__menu-item ><a href="/assets/Arsh Sharma Resume.pdf" >Resume</a> <li class=masthead__menu-item ><a href="/about/" >About Me</a> <li class=masthead__menu-item ><a href="/blog/" >Blog</a> </ul> <button class="greedy-nav__toggle hidden" type=button > <span class=visually-hidden >Toggle menu</span> <div class=navicon ></div> </button> <ul class="hidden-links hidden"></ul> </nav> </div> </div> </div> <div class="blog-container "> <div class=blog-breadcrumbs > <a href="/">Home</a> » <a href="/blog/">Posts</a> </div> <div class=blog-post > <h1 class=blog-title >Workflow</h1> <div class=blog-meta > <span class=blog-date >0001-01-01</span> <span class=blog-sep > · </span> <span class=blog-author >Arsh Sharma</span> </div> <div class=blog-content > </div> </div> </div> </div> </div> <div class=page__footer > <footer> <section class=social-icons > <div class=social-icons-container > <a href="https://x.com/Sov_trotter" target=_blank  class=social-icon  data-handle="@yourusername" title="X (formerly Twitter)"> <svg width=24  height=24  viewBox="0 0 24 24" fill=currentColor > <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/> </svg> <span class=social-handle >@yourusername</span> </a> <a href="https://linkedin.com/in/Sov-trotter" target=_blank  class=social-icon  data-handle=yourusername  title=LinkedIn > <svg width=24  height=24  viewBox="0 0 24 24" fill=currentColor > <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/> </svg> <span class=social-handle >yourusername</span> </a> <a href="https://github.com/Sov-trotter" target=_blank  class=social-icon  title=GitHub > <svg width=24  height=24  viewBox="0 0 24 24" fill=currentColor > <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/> </svg> </a> <a href="mailto:sharmarsh15@gmail.com" class=social-icon  title=Email > <svg width=24  height=24  viewBox="0 0 24 24" fill=currentColor > <path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/> </svg> </a> </div> </section> <div class=page__footer-copyright >&copy; Arsh Sharma. Powered by <a href="https://github.com/tlienart/Franklin.jl">Franklin</a> &amp; <a href="https://julialang.org" rel=nofollow >The Julia Language</a>.</div> </footer> </div> <script src="/libs/minimal-mistakes/main.min.js"></script> <script defer src="https://use.fontawesome.com/releases/v5.8.2/js/all.js" integrity="sha384-DJ25uNYET2XCl5ZF++U8eNxPWqcKohUUBUpKGlNLMchM7q4Wjg2CUpjHLaL8yYPH" crossorigin=anonymous ></script> <script src="https://unpkg.com/typed.js@2.0.16/dist/typed.umd.js" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/npm/typed.js@2.0.16/dist/typed.umd.js';"></script> <script> document.addEventListener('DOMContentLoaded', function() { var typewriterElement = document.querySelector('.typewriter'); if (typewriterElement && typeof Typed !== 'undefined') { new Typed('.typewriter', { strings: ['नमस्ते।', 'Namaste', 'ನಮಸ್ಕಾರ', 'வணக்கம்', 'നമസ്കാരം', 'নমস্কার', 'नमस्कारः', 'नमस्कार', 'નમસ્કાર', 'Hola', 'Bonjour'], typeSpeed: 120, backSpeed: 50, loop: true, showCursor: true, cursorChar: '|', autoInsertCss: true, backDelay: 2000, startDelay: 1000 }); } else if (typewriterElement) { typewriterElement.textContent = 'नमस्ते।'; } }); </script> <div class=franklin-content ><h1 id=geometrybasics_support ><a href="#geometrybasics_support" class=header-anchor >GeometryBasics support</a></h1> <h2 id=wip_a_hrefhttpsgithubcomjuliageoshapefilejlpull39shapefilejl ><a href="#wip_a_hrefhttpsgithubcomjuliageoshapefilejlpull39shapefilejl" class=header-anchor >&#91;WIP&#93; <a href="https://github.com/JuliaGeo/Shapefile.jl/pull/39">Shapefile.jl</a>:</a></h2> <ul> <li><p><code>GeoInterface</code> geometry types are replaced by the meta-geometry types from <code>GeometryBasics</code></p> </ul> <pre><code class="julia hljs"><span class=hljs-keyword >const</span> Point = Point{<span class=hljs-number >2</span>, <span class=hljs-built_in >Float64</span>}

<span class=hljs-keyword >const</span> MultiPoint = typeof(MultiPointMeta(y::<span class=hljs-built_in >Float64</span>[Point(<span class=hljs-number >0</span>)], m::<span class=hljs-built_in >Float64</span>, 
                                         boundingbox=Rect(<span class=hljs-number >0.0</span>, <span class=hljs-number >0.0</span>, <span class=hljs-number >2.0</span>, <span class=hljs-number >2.0</span>))) 

<span class=hljs-comment ># and so on for other shapefile geometries</span></code></pre> <ul> <li><p>Geometry contructors:</p> </ul> <p>The construction of geometries is pretty simple and is handled well by <code>GeometryBasics</code> meta-geometry constructors, except for <code>Polygon</code> where we had to take an extra dependency to capture the case where it might have <a href="https://gist.github.com/jkrumbiegel/b82def0a3fb0a822963ec7f97278190c">multiple exterior rings</a>. <br>Thanks to <a href="https://github.com/greimel">Fabian Greimel</a>, who <a href="https://github.com/JuliaGeo/Shapefile.jl/pull/39#issuecomment-671595669">solved</a> it in no time&#33;</p> <ul> <li><p>Tabular Interface</p> </ul> <p>We put the collection of meta-geometries and the properties file <code>.dbf</code> into a <code>StructArray</code> for tablular representation. </p> <pre><code class="julia hljs"><span class=hljs-keyword >function</span> structarray(shp::Handle, dbf::DBFTables.Table)
    dbf_cols = Tables.columntable(dbf)
    meta = collect(GB.meta(s) <span class=hljs-keyword >for</span> s <span class=hljs-keyword >in</span> shp.shapes)
    meta_cols = Tables.columntable(meta)
    <span class=hljs-keyword >return</span> StructArray(Geometry = collect(GB.metafree(i) <span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> shp.shapes); meta_cols..., dbf_cols...)
<span class=hljs-keyword >end</span></code></pre> <h2 id=wipa_hrefhttpsgithubcomvisrgeojsontablesjlpull3geojsontablesjl ><a href="#wipa_hrefhttpsgithubcomvisrgeojsontablesjlpull3geojsontablesjl" class=header-anchor >&#91;WIP&#93;<a href="https://github.com/visr/GeoJSONTables.jl/pull/3">GeoJSONTables.jl</a>:</a></h2> <ul> <li><p>Feature</p> </ul> <p>The package defines it&#39;s own Feature type that binds a geometry with it&#39;s properties. We went for this method rather than directly using GeometryBasics metageometry constructors to be able to support the case of heterogeneous geomtries that has been discussed below.</p> <pre><code class="julia hljs"><span class=hljs-keyword >struct</span> Feature{T, Names, Types}
    geometry::T
    properties::<span class=hljs-built_in >NamedTuple</span>{Names, Types}
<span class=hljs-keyword >end</span></code></pre> <ul> <li><p>Methods</p> </ul> <p>Unlike <code>Shapefile.jl</code>, <code>GeoJSONTables.jl</code> follows a semi-lazy <code>JSON</code> parsing. A <code>read&#40;&#41;</code> method directly reads the raw jsonbytes into a StructArray <code>Table</code>. The <code>read&#40;&#41;</code> method has two major parts:</p> <p> 1&#41; The <code>JSON3</code> parsing:</p> <pre><code class="julia hljs">fc = JSON3.read(jsonbytes)</code></pre>
<p>    2&#41; Populating and constructing GeometryBasics features :</p>
<pre><code class="julia hljs">f = fc.features
     <span class=hljs-keyword >for</span> f <span class=hljs-keyword >in</span> jsonfeatures 
            geom = f.geometry
            prop = f.properties
            
            <span class=hljs-comment ># only properties missing</span>
            <span class=hljs-keyword >if</span> geom !== <span class=hljs-literal >nothing</span> &amp;&amp; prop === <span class=hljs-literal >nothing</span>
                Feature(geometry(geom), miss(a))
            
            <span class=hljs-comment ># only geometry missing            </span>
            <span class=hljs-keyword >elseif</span> geom === <span class=hljs-literal >nothing</span> &amp;&amp; prop !== <span class=hljs-literal >nothing</span>
                Feature(<span class=hljs-literal >missing</span>, prop)
            
            <span class=hljs-comment ># none missing</span>
            <span class=hljs-keyword >elseif</span> geom !== <span class=hljs-literal >nothing</span> &amp;&amp; prop !== <span class=hljs-literal >nothing</span>
                Feature(geometry(geom), prop)
            
            <span class=hljs-comment ># both missing            </span>
            <span class=hljs-keyword >elseif</span> geom === <span class=hljs-literal >nothing</span> &amp;&amp; prop === <span class=hljs-literal >nothing</span>
                Feature(<span class=hljs-literal >missing</span>, miss(a))
            <span class=hljs-keyword >end</span>
        <span class=hljs-keyword >end</span></code></pre>
<ul>
<li><p>Missing values</p>

</ul>
<p>The package now supports efficient handling of <code>missing</code> data. This happens right during the construction of geometries&#40;<code>GeoJSONTables.geometry</code> method that accepts a <code>JSON3.Object</code>&#41;.  In the above example you can see a <code>miss&#40;&#41;</code> method, which captures all the cases where a <code>JSON3</code> output might reult in <code>nothing</code>.</p>
<ul>
<li><p>StructArrays and Tabular interface</p>

</ul>
<p>This is the part that needed a careful design. One of the features of a <code>GeoJSON</code> format is that it allows for heterogeneous features i.e, there can be multiple geometry types in a single <code>GeoJSON</code> file. The challenge was getting the Tables interface to automatically widen to the appropriate types in case of heterogeneous features/geometries. eg: If a Feature has a <code>Point</code> type and a <code>Polygon</code> type, the type of our geometries column should automatically widen to <code>Any</code> and the Feature as <code>Feature&#123;Any, Names, Types&#125;</code>. This required defining <code>StructArrays.staticschema</code>, <code>StructArrays.createinstance</code> and <code>Base.getproperty</code> overloads to work well with our <code>Feature</code> type. The method is well documented in <a href="https://github.com/JuliaArrays/StructArrays.jl#advanced-structures-with-non-standard-data-layout">StructArrays.jl</a>.</p>
<ul>
<li><p>Lower level interface</p>

</ul>
<p>For a faster, lower level interface and greater flexibility with the data, one can directly have a <code>JSON3.Dict</code> to avoid the process of  conversion to GeometryBasics geometries and the Tables interface. Though it is not recommended if one wishes to use the data further for processing, plotting or performing spatial operations.</p>
<pre><code class="julia hljs">GeoJSONTables.JSON3.read(jsonbytes)</code></pre>
</div>

      </div> 
    </div>   

    <div class=page__footer >
      <footer>
        
        
        <section class=social-icons >
          <div class=social-icons-container >
            <a href="https://x.com/Sov_trotter" target=_blank  class=social-icon  data-handle="@yourusername" title="X (formerly Twitter)">
              <svg width=24  height=24  viewBox="0 0 24 24" fill=currentColor >
                <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
              </svg>
              <span class=social-handle >@yourusername</span>
            </a>
            
            <a href="https://linkedin.com/in/Sov-trotter" target=_blank  class=social-icon  data-handle=yourusername  title=LinkedIn >
              <svg width=24  height=24  viewBox="0 0 24 24" fill=currentColor >
                <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
              </svg>
              <span class=social-handle >yourusername</span>
            </a>
            
            <a href="https://github.com/Sov-trotter" target=_blank  class=social-icon  title=GitHub >
              <svg width=24  height=24  viewBox="0 0 24 24" fill=currentColor >
                <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
              </svg>
            </a>
            
            <a href="mailto:sharmarsh15@gmail.com" class=social-icon  title=Email >
              <svg width=24  height=24  viewBox="0 0 24 24" fill=currentColor >
                <path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/>
              </svg>
            </a>
          </div>
        </section>
        
        <div class=page__footer-copyright >&copy; Arsh Sharma. Powered by <a href="https://github.com/tlienart/Franklin.jl">Franklin</a> &amp; <a href="https://julialang.org" rel=nofollow >The Julia Language</a>.</div>
      </footer>
    </div>

    <script src="/libs/minimal-mistakes/main.min.js"></script>
    <script defer src="https://use.fontawesome.com/releases/v5.8.2/js/all.js" integrity="sha384-DJ25uNYET2XCl5ZF++U8eNxPWqcKohUUBUpKGlNLMchM7q4Wjg2CUpjHLaL8yYPH" crossorigin=anonymous ></script>

    
    
        


    

    
    <script src="https://unpkg.com/typed.js@2.0.16/dist/typed.umd.js" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/npm/typed.js@2.0.16/dist/typed.umd.js';"></script>
    
    
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        var typewriterElement = document.querySelector('.typewriter');
        if (typewriterElement && typeof Typed !== 'undefined') {
          new Typed('.typewriter', {
            strings: ['नमस्ते।', 'Namaste', 'ನಮಸ್ಕಾರ', 'வணக்கம்', 'നമസ്കാരം', 'নমস্কার', 'नमस्कारः', 'नमस्कार', 'નમસ્કાર', 'Hola', 'Bonjour'],
            typeSpeed: 120,
            backSpeed: 50,
            loop: true,
            showCursor: true,
            cursorChar: '|',
            autoInsertCss: true,
            backDelay: 2000,
            startDelay: 1000
          });
        } else if (typewriterElement) {
          typewriterElement.textContent = 'नमस्ते।';
        }
      });
    </script>